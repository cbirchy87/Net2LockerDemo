@using Net2LockerDemo.Services.Models
@inject Net2CommsService net2;

@if(Net2Users is not null)
{
    @foreach (var user in Net2Users)
    {
        <div class="card">
            <div class="card-header">
                Locker - @user.firstname @user.lastname 
            </div>
            <div class="card-body">
                <h5 class="card-title">Order Recieved</h5>
                <p class="card-text">Pressing the button below will issue a new pin to the locker.</p>

                <button class="btn btn-primary" @onclick="(()=> SetNewPinToLocker(user.id))">Set Pin</button>
            </div>
        </div>
    }
}

@code {
    public List<Net2User> Net2Users { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Net2Users = await net2.GetNet2Users();
    }

    private async Task SetNewPinToLocker(int userid)
    {
        await net2.UpdateUserPin(userid, "8888");
    }
}
